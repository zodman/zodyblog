
var SpinButton=Control.extend({'__counter':null,'__action':null,'initialize':function(textInput,options){this.SpinButton=$(textInput);this.components={};this.options={};this.__statusVars={'up':false,'down':false};this.__timerId=null;this.__buildComponents();this.__setDefaultOptions(options);this.__bindEvents();},'__textKeyDown':function(e){var e=new Event(e);if(e.key=='down'){if(window.ie!=undefined){this.down();}else{this.__setAction('down')}}else if(e.key=='up'){if(window.ie!=undefined){this.up();}else{this.__setAction('up')}}},'__buildComponents':function(){this.components.element=Widget.table({'class':'m-spinbutton'});this.components.text=this.SpinButton.clone(true);this.components.buttonUp=Widget.img({'class':'increase',src:$mediaDir+'spinbutton/spin-up.png'});this.components.buttonDown=Widget.img({'class':'decrease',src:$mediaDir+'spinbutton/spin-down.png'});this.components.element.appendChild(Widget.tbody(null,Widget.tr(null,[Widget.td(null,this.components.text),Widget.td({'class':'buttons'},[this.components.buttonUp,this.components.buttonDown])])));this.element=this.components.element;$(this.SpinButton).parentNode.insertBefore(this.components.element,$(this.SpinButton));$(this.SpinButton).hide();},'__updateValue':function(){this.components.text.value=this.options.values?this.options.values[this.SpinButton.value]:this.SpinButton.value;},'__setDefaultOptions':function(options){this.options.values=options.values||null;this.options.minValue=(typeof options.minValue!='undefined')?options.minValue:0;this.options.maxValue=(typeof options.maxValue!='undefined')?options.maxValue:(options.values?(options.values.length-1):1);this.options.step=(typeof options.step!='undefined')?options.step:(options.values?1:0.1);this.options.cycle=options.cycle||false;this.options.defaultValue=(typeof options.defaultValue!='undefined')?options.defaultValue:this.options.minValue;this.onChange=options.onChange||function(){};this.options.minValue=new Number(this.options.minValue);this.options.maxValue=new Number(this.options.maxValue);this.SpinButton.value=this.options.defaultValue;this.__updateValue();},'stop':function(){window.clearTimeout(this.__timer);},'__clear':function(){$clear(this.__timer);this.__action=false;},'__setTimer':function(interval){$clear(this.__timer);this.__interval=interval;this.__timer=this.__modifyValue.periodical(this.__interval,this);},'__setActionUp':function(){this.__setAction('up');},'__setActionDown':function(){this.__setAction('down');},'__setAction':function(action,time){this.__counter=1;this.__clear();this.__action=action;this.__setTimer(150);},'up':function(){this.__action='up';this.__modifyValue()
this.__action=null;},'down':function(){this.__action='down';this.__modifyValue()
this.__action=null;},'__bindEvents':function(){this.addListener(this.components.text,'keydown',this.__textKeyDown);this.addListener(this.components.text,'keyup',this.stop);this.addListener(this.components.text,'blur',this.stop);this.addListener(this.components.buttonUp,'mousedown',this.__setActionUp);this.addListener(this.components.buttonDown,'mousedown',this.__setActionDown);this.addListener(this.components.buttonUp,'click',this.up);this.addListener(this.components.buttonDown,'click',this.down);this.addListener(document.body,'mouseup',this.stop);},'setValue':function(value){value=new Number(value);if(value%this.options.step==0){if((value<=this.options.maxValue)&&(value>=this.options.minValue)){this.SpinButton.value=value;this.__updateValue();}}},'getValue':function(){return new Number(this.SpinButton.value);},'__modifyValue':function(){var res=null;var val=new Number(this.SpinButton.value);switch(this.__action){case'up':if(val<this.options.maxValue){res=val+this.options.step;if(res.toString().match(/\./i)){res=res.toFixed(3);}
this.SpinButton.value=res;}else{if(this.options.cycle){this.SpinButton.value=this.options.minValue;}}
break;case'down':if(val>this.options.minValue){res=val-this.options.step;if(res.toString().match(/\./i)){res=res.toFixed(3);}
this.SpinButton.value=res;}else{if(this.options.cycle){this.SpinButton.value=this.options.maxValue;}}
break;}
this.__updateValue();if(this.onChange){this.onChange(this.SpinButton);}
if(this.__counter%5==0){if(this.__interval>5){this.__setTimer(Math.floor(this.__interval-this.__interval/6));}
this.__counter=1;}
this.__counter++;}});var spinButton=SpinButton;